# 宿のシフト管理アプリ 要件定義書 (YAMLベース)

version: 1.1 # 【更新】
date: 2024-05-21 # 【更新】最終更新日

application:
  name: 宿のシフト管理アプリ
  summary: 宿泊施設向けフロントエンド完結型シフト管理アプリケーション
  target_users:
    - シフト管理者 (宿泊施設)
    - 従業員 (閲覧主体)
  background_and_purpose:
    current_issues: CSVファイルのみでの管理は視認性・操作性に課題あり。
    purpose:
      - シフト作成・編集作業の効率化
      - シフト情報の視覚的な把握の容易化
      - 従業員間の情報共有の円滑化
      - 人的ミスの削減
      - データ管理の柔軟性向上
  system_configuration:
    - フロントエンドアプリケーションとしてユーザーのウェブブラウザ上で動作。
    - サーバーサイド処理やデータベースは原則として持たない。
    - データはユーザーのブラウザのローカルストレージに保存。
    - 主要技術要素: HTML, CSS, JavaScript (適切なフレームワーク/ライブラリ)。
    - 【追記】ガントチャート表示・編集ライブラリ: vue-ganttastic (または同等のVue 3対応ライブラリ) の利用を検討。

functional_requirements:
  data_management:
    - id: F-DM-001
      name: ローカルストレージへのデータ保存
      description: |
        シフトデータ（割り当て済みタスク）、スタッフ情報（氏名、休日）、
        業務テンプレート情報をユーザーのブラウザのローカルストレージに保存する。
        アプリケーションを閉じてもデータは保持される。
    - id: F-DM-002 # 【更新】
      name: CSVインポート
      description: |
        指定形式のCSVファイル（UTF-8、カンマ区切り）をインポートし、
        アプリケーション内のデータ形式（主に割り当て済みタスク）に変換して取り込む。
        CSVの1行を1つの勤務タスクとして扱い、休憩時間はタスクの備考などに記録する。
        業務内容はCSV形式に含まず、インポート時はデフォルトのタスク名（例: 「勤務」）で登録する。
        インポート時に既存の割り当て済みタスクデータは上書きされる。
        CSVに記載されたスタッフがシステムに存在しない場合は新規スタッフとして追加する。
        エラーハンドリング（不正形式、必須項目欠損）。
      csv_format: # 【更新】
        headers_example: # ヘッダーの例 (順不同可)
          - 日付 (YYYY-MM-DD または YYYY/MM/DD)
          - 名前 (スタッフ名)
          - 開始時刻 (HH:MM, 業務開始)
          - 終了時刻 (HH:MM, 業務終了)
          - 休憩開始 (HH:MM, オプショナル)
          - 休憩終了 (HH:MM, オプショナル)
        encoding: UTF-8
        delimiter: カンマ (,)
    - id: F-DM-003 # 【更新】
      name: CSVエクスポート
      description: |
        アプリケーション内の割り当て済みタスクデータを、F-DM-002で定義された
        ヘッダー形式のCSVファイルとしてエクスポート（ダウンロード）できる。
    - id: F-DM-004
      name: JSONインポート
      description: |
        アプリケーション独自のデータ構造（スタッフ情報、休日情報、業務テンプレート、
        割り当て済みタスク等を含む）を持つJSONファイルをインポートし、
        アプリケーションデータとして取り込む。
        インポート時に既存の全アプリケーションデータを上書きする。
    - id: F-DM-005
      name: JSONエクスポート
      description: |
        アプリケーション内の全データ（スタッフ情報、休日情報、業務テンプレート、
        割り当て済みタスク等）を、アプリケーション独自のデータ構造のJSONファイルとして
        エクスポート（ダウンロード）できる。主にバックアップやデータ移行を目的とする。
    - id: F-DM-006
      name: データクリア機能
      description: |
        ローカルストレージに保存されている全てのアプリケーションデータをクリアする機能。
        誤操作防止のため確認ダイアログを表示する。

  view_features:
    - id: F-VW-001
      name: カレンダービュー (月次)
      description: |
        選択された月のカレンダーを表示。各日付セルに勤務概要を簡易表示。
        日付セルクリックで日次ビューへ遷移。前後月ナビゲーション。
    - id: F-VW-002
      name: ガントチャートビュー (週次)
      description: |
        選択された週のシフトをガントチャート形式で表示。
        縦軸に従業員名（リソース）、横軸に日付と時間（調整可能）。
        タスクバーで勤務時間帯と業務概要（タスク名）を表示。前後週ナビゲーション。
    - id: F-VW-003
      name: ガントチャートビュー (日次)
      description: |
        選択された日のシフトをガントチャート形式で詳細表示。
        縦軸に従業員名（リソース）、横軸に時間（調整可能）。
        タスクバーで勤務時間帯と業務詳細（タスク名、備考）を表示。前後日ナビゲーション。
    - id: F-VW-004
      name: 休日/指定休の表示
      description: |
        アプリ内で設定された休日/指定休の従業員をガントチャート上で視覚的に非稼働表示する。
        (例: 特定の色、パターン、またはタスクバー非表示)。

  shift_editing_features: # 主に日次・週次ガントチャート上
    - id: F-ED-001
      name: タスクの新規作成・割り当て
      description: |
        ガントチャート上の空き時間や「未割り当て業務」プールから業務を選択し、
        ドラッグ＆ドロップまたはクリック操作でタスクを割り当て。
        開始/終了時刻（デフォルト期間設定可、調整可）、担当従業員、業務内容を設定。
    - id: F-ED-002
      name: タスクバーの長さ調整
      description: |
        タスクバーの開始/終了時刻の端をドラッグし、勤務時間（タスク期間）を調整。
        時間単位は設定可能（例: 15分、1時間）。
    - id: F-ED-003
      name: タスクの移動
      description: |
        タスクバーをドラッグ＆ドロップで、別の時間帯や別の従業員に移動。
    - id: F-ED-004
      name: タスク内容の編集
      description: |
        タスクバークリック（またはダブルクリック）でモーダル等を表示し、
        タスク詳細（業務内容テキスト、場所、備考、日時など）を編集。
    - id: F-ED-005
      name: タスクの削除
      description: |
        タスクバーを選択し、削除ボタンまたはDeleteキーでタスクを削除。確認ダイアログ（任意）。
    - id: F-ED-006
      name: タスクの複製
      description: |
        既存タスクを複製し、別の時間や従業員に割り当てる機能。

  staff_management_features:
    - id: F-SM-001
      name: スタッフの登録
      description: 新しいスタッフの氏名を登録。
    - id: F-SM-002
      name: スタッフの編集
      description: 既存スタッフの氏名を編集。
    - id: F-SM-003
      name: スタッフの削除
      description: |
        既存スタッフを削除。割り当て済みタスクがある場合はそれらも削除（デフォルト）。
        関連する休日情報も削除。
    - id: F-SM-004
      name: スタッフの休日/指定休設定
      description: カレンダー等を利用し、スタッフの公休や指定休を日付単位で設定。

  task_management_features: # 業務管理機能
    - id: F-TM-001
      name: 業務テンプレートの登録
      description: |
        頻用する業務内容をテンプレートとして登録。
        テンプレート情報：業務名、デフォルト所要時間（任意）、業務カテゴリ（任意）。
    - id: F-TM-002
      name: 業務テンプレートの編集・削除
      description: 登録済み業務テンプレートを編集・削除。
    - id: F-TM-003
      name: 「未割り当て業務」プールへのテンプレートからの追加
      description: |
        日次・週次ビューの「未割り当て業務」プール等に、登録テンプレートから業務を追加。

non_functional_requirements:
  - id: NF-UIUX-001 # ID体系を少し変更
    category: UI/UX
    description: |
      シンプルで直感的なUI。学習コストの低い操作性。視覚的に分かりやすいデザイン。
      ガントチャートの操作性（ドラッグ、リサイズ等）はスムーズであること。
  - id: NF-PERF-001
    category: Performance
    description: |
      一般的な利用状況（従業員30名、1ヶ月データ）でも表示・操作が遅延しない。
      ドラッグ＆ドロップ操作がスムーズであること。
  - id: NF-BROW-001
    category: Browser Compatibility
    description: 最新版の主要モダンブラウザ（Chrome, Firefox, Edge, Safari）で動作。
  - id: NF-SEC-001
    category: Security
    description: データはユーザーのローカルストレージにのみ保存。外部サーバーへの送信なし。
  - id: NF-MAIN-001 # 【更新】
    category: Maintainability
    description: |
      コードは適切に構造化され、将来的な機能追加や修正が比較的容易であること。
      (JavaScriptフレームワークの利用を推奨)
      ガントチャート機能は外部ライブラリ(例: vue-ganttastic)を利用する場合、
      そのライブラリの更新追従も考慮する。

future_enhancements: # 検討事項
  - 勤務時間の自動集計機能
  - 人員過不足アラート機能
  - 休憩時間管理機能（勤務タスク内の休憩時間として設定・表示・集計）
  - シフトパターン保存/読込機能
  - 印刷機能
  - 競合チェック機能（重複割り当て防止または警告）

constraints_and_prerequisites:
  development_environment:
    - フロントエンド技術（HTML, CSS, JavaScript）のみで開発。
    - 【追記】ガントチャート機能には vue-ganttastic または同等の外部Vueライブラリを利用。
  operational_environment:
    - サポートするモダンブラウザがインストールされたPC環境での利用を前提。
    - インターネット接続は初期ロード時に必要、データ操作はローカルで可能（同期はスコープ外）。
  exclusions:
    - サーバーサイド機能（DB連携、複数ユーザー同時編集、リアルタイム同期など）
    - ユーザー認証機能
    - 専用モバイルアプリ開発（モバイルブラウザでの閲覧は考慮するがPC操作が主）

glossary: # (任意)
  - term: ローカルストレージ
    definition: ウェブブラウザが提供する、ユーザーのコンピュータ上にデータを保存する仕組み。
  - term: ガントチャート
    definition: |
      プロジェクト管理や生産管理などで工程管理に用いられる表の一種で、
      作業計画を視覚的に表現するもの。本システムではシフトの時間的割り当てに使用。
  - term: フロントエンド
    definition: ユーザーが直接操作するウェブページの表示や動作に関する部分。
  - term: タスク
    definition: |
      個々の業務、作業単位。本システムでは、特定の時間帯に特定のスタッフに
      割り当てられた具体的な作業や勤務ブロックを指す。
  - term: 業務テンプレート
    definition: |
      頻繁に使用するタスクの雛形。タスク名やデフォルト所要時間などを含む。

revision_history:
  - version: 1.0
    date: 2024-05-16
    author: (あなたの名前)
    changes: 初版作成
  - version: 1.1 # 【追記】
    date: 2024-05-21
    author: (あなたの名前)
    changes: |
      システム構成、メンテナンス性、開発環境にガントチャートライブラリ利用の旨を追記。
      CSVインポート/エクスポート形式を更新。その他機能要件の表現を調整。